// ================= DATEN =================
const daten = {
  paedagogik: [
    {
      id: "paed-1",
      frage:
        "**Kommunikation**\n" +
        "Kommunikation in der Fahrschule …\n\n" +
        "Sachebene? – (sachlich-inhaltliche Seite)\n" +
        "Gefühlsebene? – (zwischenmenschliche Seite)",
      antwort:
        "Wer anderen etwas beibringen möchte, muss nicht nur über ein Fundiertes Wissen\n" +
        "der Grundlegenden Tatsachen zwischenmenschlicher Kommunikation verfügen.\n" +
        "je nach Gespräch und situation muss das wissen Flexibel und angemessen angewendet werden.\n\n" +
        "**Sachebene:**\n" +
        "- Kunden beraten\n" +
        "- Schwierige Sachverhalte verständlich erklären\n" +
        "- präzise unmissverständliche Anweisungen während einer Schulungsfahrt\n" +
        "- sachlich,aufgeschlossen und freundlich feedback geben\n" +
        "- konfliktgespräche führen\n" +
        "- mit kollegen diskutieren\n" +
        "- Meinungsverschiedenheiten mit prüfer sachlich und professionell klären\n\n" +
        "**Gefühlsebene:**\n" +
        "- beziehung der gesprächspartner zueinander ( lehrer / Schüler; dienstleister: Kunde\n" +
        "- sympathie und Antipathie\n" +
        "- Frage, wie sich die Gesprächsbeteiligte wechselseitig wahrnehmen\n" +
        "- Emotionen, Erfahrungen, Einstellungen\n" +
        "- eventuelle Vorurteile und empfindlichkeiten"
    },

    {
      id: "paed-2",
      frage:
        "**Kommunikation**\n" +
        "- Kommunikationsquadrat\n" +
        "- Vier-Seiten-Modell\n" +
        "- Vier-Ohren-Modell",
      antwort:
        "**Sachebene:**\n" +
        "wesentliche infos zu den Fakten sollen transportiert werden\n\n" +
        "**Beziehungsebene:**\n" +
        "defieniert wie sender und empfänger der Nachricht zueinanderstehen\n\n" +
        "**Appellebene:**\n" +
        "zu welchem,,Verhalten\" der sender den Empfänger bewegen möchte-z.b Apell an der Ampel, ,,fahr los es ist grün geworden\"\n\n" +
        "**Selbstoffenbarungsebene:**\n" +
        "in jeder nachricht, die wir senden, versenden wir etwas über uns selbst\n\n" +
        "**Fehler:**\n" +
        "Vorschnelle Interpretationen führen oft zu Fehldeutungen oder Konflikten"
    },

    {
      id: "paed-3",
      frage:
        "**Wie funktioniert das Fahren**\n\n" +
        "Der psychophysische Funktionskreis?\n" +
        "Aufbau und Funktion?",
      antwort:
        "**Aufbau:**\n" +
        "Benedikt von hebenstreit beschreibt das Fahren als einen seelischen-körperlichen (psychopysischen) regelkreis\n\n" +
        "**Funktion:**\n" +
        "Dieser Funktionskreis funktioniert mittels drei Komponenten, die zussamenarbeiten müssen\n\n" +
        "1. Infos müssen über die sinne aufgenommen werden\n" +
        "2. Infos müssen im Gehirn richtig verarbeitet werden\n" +
        "3. Muskeln führen die erforderlichen Handlungen aus"
    },

    {
      id: "paed-4",
      frage:
        "**Kommunikation**\n" +
        "was ist ,, Metakommunikation\", und was sind ,,Ich- und Du-Botschaften\"?",
      antwort:
        "**Metakommunikation:**\n" +
        "Menschen tauschen sich darüber aus, wie sie miteinander kommunizieren.\n" +
        "So können viele Konflikte gelöst oder gleich vermieden werden.\n" +
        "Es geht nur um Kommunikation über Kommunikation!\n\n" +
        "**Ich- und Du-Botschaften:**\n" +
        "Bestimmte verhaltensweisen vermeiden, damit beim Empfänger nicht auf ,,Abwehr\" gestoén wird.-Die beziehungsebene währe sofort gestört!\n" +
        "- Inhalte, die vermittelt werden sollen, könnten dann kaum aufgenommen und akzeptiert werden.\n" +
        "- Besser währe es. dem Empfänger ,,die Tür öffnen\" zu lassen (pfeil man kann dann sein gesicht wahren.\n\n" +
        "**Hinweis:**\n" +
        "- ,,Nun, Sie müssen es lernen, ich kann es schon!\""
    },

    {
      id: "paed-5",
      frage:
        "**Komunikation**\n" +
        "was sind offene und Geschlossene Fragen?",
      antwort:
        "**Offene und geschlossene Fragen:**\n\n" +
        "**Man entscheidet durch bestimmte Fragetechniken die ,,Richtung\", den ,,Verlauf\" und das ,,,Tempo\" eines Gesprächs.\n\n" +
        "**Offene Fragen:**\n" +
        "- möglichst viele Infos den Schüler geben!\n" +
        "- viele verschieden mögliche Antworten möglich\n\n" +
        "Beispiel:\n" +
        "Frage schüler: wie findet ihr den Unterricht?\n" +
        "Antwort der schüler: Ganz okay.\n\n" +
        "**Geschlossene Fragen:**\n" +
        "- eine Entscheidung bzw. Antwort gezielt herbeiführen\n" +
        "- rechtzeitige Bestätigung und Absicherung\n\n" +
        "Beispiel:\n" +
        "Frage schüler: Wie findet ihr den Unterricht auf eine Skala von 1-10?\n" +
        "Antwort der Schüler: Geziehlt eine zahl z.b.:,,1\"."
    },

    {
      id: "paed-6",
      frage:
        "**Kommunikation**\n" +
        "Watzlawicks 5 Axiome der Menschlichen Kommunikation?",
      antwort:
        "**1) Man kann nicht ,,nicht\" Komunieziren!**\n" +
        "Auch Unterlassen ist ein Verhalten ,,beherrschtes Schweigen\".\n" +
        "Schweigen ist eine Kommunikative Handlung (evtl. Fehlinterpretation und Unterstellung haben freien Lauf)\n\n" +
        "**2) Jede Kommunikation hat einen Inhalts- und einen Beziehungspunkt, in welcher der Beziehungsaspeckt über dem Inhalt steht!**\n" +
        "Isd die Beziehungsebene gut, so ist dies ein Vorteil (Kritische punkte aushalten)!\n\n" +
        "**3) Die Natur einer beziehung ist durch die Interpunktion der Kommunikationsabläufe seitens der Partner bestimmt!**\n" +
        ",,Was wir bereits zussamen erlebt haben\" / Faktor Zeit spielt in Kommunikativen Prozessen eine wichtige Rolle /\n" +
        "kleine Aufmunterungen evtl. Wendepunkt in der Ausbildung (Aufschaukelungsprozesse)\n\n" +
        "**4) Menschliche Kommunikation ist digita und analog!**\n" +
        "Komplexe Inhalte/Zussammenhänge sind analog (nonverbal) kaum zu vermitteln und deshalb besser digital (verbal) zu vermitteln\n\n" +
        "**5) Zwischenmenschliche Kommunikationabläufe sind entweder symmetrisch oder komplementär ...**\n" +
        "Beispiel:\n" +
        ",,Je nachdem ob wir mit Lehrern oder Vorgesetzten reden, Kommunizieren wir anders, alswenn die Hierarchiestufe gleich ist.\n" +
        "Anders in der Fahrschule: Hier ergibt sich ein ambivalentes Bild. Hier ist man als Fahrlehrer auch Dienstleister gegenüber dem Kunde,\n" +
        "welcher Schüler aund Auftraggeber zugleich ist. Dieses gleichzeite Über- und Untergeordnetsein ermöglicht eine Begegnung auf Augenhöhe\"."
    },

    {
      id: "paed-7",
      frage:
        "**Lernen**\n" +
        "Die vier Phasen des Lernens",
      antwort:
        "**Oberbegriff: VASE**\n\n" +
        "V = **Vorbereiten:** Vorgespräch / Ziele u. Inhalte = Fahrschüler macht sich Gedanken (sucht nach Spuren ggf. Vorstunde)\n\n" +
        "A = **Aneignen:** Fahrlehrer leitet Fahrschüler an = Neue Verknüpfungen werden hergestellt (Bsp. rechts vor links - Fuß über Bremspedal / bremsbereit sein)\n\n" +
        "S = **Speichern:** Üben und wiederholen festigt neue Fähigkeiten und Fertigkeiten (neue Spuren werden gefestigt)\n\n" +
        "E = **Erinnern:** Zurückgreifen auf vorherige Spuren und merfaches wiederholen.\n" +
        "Handlung - mehrere unterschiedliche Impulse werden miteinander Verknüpft ( Motorik; Sehvermögen)\n" +
        "Den Fahrschüler aktiv in der Theorie und die Praxis einbinden ,,Multisensorisch wahrnehmen\" lassen\n" +
        "(durch seine Sinne schafft der Fahrschüler die ,,Speicherung\")"
    },

    {
      id: "paed-8",
      frage:
        "**Praktische Ausbildung**\n" +
        "Strukturierung der Praktischen Übungsstunde -(Fahrstunde)\n" +
        "Eine Fahrstunde soll sinnvoll geglieder sein.-Grundrhythmen...",
      antwort:
        "**1. Vorbesprechung**\n" +
        "**2. Durchführung der Fahrstunde**\n" +
        "**3. Üben von neuem Inhalt**\n" +
        "**4. Zwischenbesprechung**\n" +
        "**5. Vertiefen von neuem Inhalt**\n" +
        "**6. Lernzielkontrolle**\n" +
        "**7. Wiederholung von bekanntem Inhalt**\n" +
        "**8. Nachbesprechung**\n" +
        "**9. Dokumentation (Diagrammkarte)**\n\n" +
        "**Unverzichtbar**\n" +
        "- Vor-und Nachbesprechung\n" +
        "- Üben und Überprüfen neuer und / oder Bekannter Inhalte\n" +
        "- Lernzielkontrolle\n" +
        "- Dokumentation der Ergebnisse\n\n" +
        "**Wichtig:**\n" +
        "- Rhytmus der Stunde-(Wechsel zwischen Phasen Höherer und niedrieger Beanspruchung)\n" +
        "- Vermeiden von Überforderungen\n" +
        "- Fördern des realistischen Selbsteinschätzung des Schülers\n" +
        "- bei Überforderung evtl. Zielkorrektur-im Extremfall Abbruch der Stunde.\n" +
        "- Die Dokumentation über eine Ausbildungsdiagrammkarte ist erforderlich und wird zu verlangen sein.\n" +
        "- Die praktische Ausbildung soll mit der Theoretischen verzahnt werden. Umgekehrt soll auch im Theorieunterricht auf die Praktische Ausbildung Bezug genommen werden."
    }
  ]
};

// ================= LOGIK =================
let aktuelleKarten = [];
let aktuellePosition = 0;

// **Text rendern: Fett + Zeilenumbrüche**
function renderText(text) {
  if (!text) return "";
  let html = text.replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>");
  html = html.replace(/\n/g, "<br>");
  return html;
}

function themaWechseln() {
  const select = document.getElementById("themaSelect");
  const thema = select ? select.value : "alle";

  aktuelleKarten =
    thema === "alle" ? Object.values(daten).flat() : (daten[thema] || []);

  aktuellePosition = 0;
  zeigeKarte();
}

function zeigeKarte() {
  const frageEl = document.getElementById("frage");
  const antwortEl = document.getElementById("antwort");
  const infoEl = document.getElementById("kartenInfo");
  const statusEl = document.getElementById("lernStatusInfo");

  if (!frageEl || !antwortEl) return;

  if (aktuelleKarten.length === 0) {
    frageEl.innerText = "Keine Karten vorhanden";
    antwortEl.style.display = "none";
    if (infoEl) infoEl.innerText = "";
    if (statusEl) statusEl.innerText = "";
    return;
  }

  const karte = aktuelleKarten[aktuellePosition];

  frageEl.innerHTML = renderText(karte.frage);
  antwortEl.innerHTML = renderText(karte.antwort);
  antwortEl.style.display = "none";

  if (infoEl) {
    infoEl.innerText = `Karte ${aktuellePosition + 1} von ${aktuelleKarten.length}`;
  }

  const status = JSON.parse(localStorage.getItem("gelerntStatus")) || {};
  const stufe = status[karte.id] || 0;

  if (statusEl) {
    statusEl.innerText =
      stufe === 0 ? "Status: Nicht gelernt"
      : stufe === 1 ? "Status: Gelernt"
      : "Status: Sicher gelernt";
  }
}

function naechsteKarte() {
  if (aktuelleKarten.length === 0) return;
  aktuellePosition = (aktuellePosition + 1) % aktuelleKarten.length;
  zeigeKarte();
}

function zufallsKarte() {
  if (aktuelleKarten.length === 0) return;

  const status = JSON.parse(localStorage.getItem("gelerntStatus")) || {};
  const pool = [];

  aktuelleKarten.forEach((karte, index) => {
    const stufe = status[karte.id] || 0;
    const gewicht = stufe === 0 ? 5 : stufe === 1 ? 2 : 1;
    for (let i = 0; i < gewicht; i++) pool.push(index);
  });

  aktuellePosition = pool[Math.floor(Math.random() * pool.length)];
  zeigeKarte();
}

function antwortZeigen() {
  const a = document.getElementById("antwort");
  if (!a) return;
  a.style.display = a.style.display === "none" ? "block" : "none";
}

function gelernt() {
  if (aktuelleKarten.length === 0) return;
  const status = JSON.parse(localStorage.getItem("gelerntStatus")) || {};
  const id = aktuelleKarten[aktuellePosition].id;

  status[id] = Math.min((status[id] || 0) + 1, 2);
  localStorage.setItem("gelerntStatus", JSON.stringify(status));
  zeigeKarte();
}

function gelerntZuruecksetzen() {
  if (aktuelleKarten.length === 0) return;
  const status = JSON.parse(localStorage.getItem("gelerntStatus")) || {};
  delete status[aktuelleKarten[aktuellePosition].id];

  localStorage.setItem("gelerntStatus", JSON.stringify(status));
  zeigeKarte();
}

function geheZuKarte() {
  const input = document.getElementById("kartenNummer");
  if (!input) return;

  const n = parseInt(input.value);
  if (isNaN(n)) return;

  if (n >= 1 && n <= aktuelleKarten.length) {
    aktuellePosition = n - 1;
    zeigeKarte();
  }
}

// Start
window.addEventListener("load", () => {
  themaWechseln();
});
